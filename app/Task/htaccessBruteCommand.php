<?php
/**
 * Author: Damian Schwyrz <mail@damianschwyrz.de>
 * URL: https://www.damianschwyrz.de
 * Copyright (c) 2018.
 */

namespace App\Task;

class htaccessBruteCommand
{

    /**
     * Create a python command which uses a wordlist for usernames and passwords.
     *
     * @param string      $url
     * @param string      $usernames
     * @param string      $passwords
     * @param int         $threads
     * @param int         $timeout
     *
     * @return string
     */
    public static function createWithUserwordlist(
        string $url,
        string $usernames,
        string $passwords,
        int $threads,
        int $timeout
    ): string {
        $cmd = [];
        $cmd[] = config("toolset.bin.python3");
        $cmd[] = config("toolset.path.htbrute_with_userwordlist");
        $cmd[] = "-url " . $url;
        $cmd[] = "-userlist " . $usernames;
        $cmd[] = "-passlist " . $passwords;
        $cmd[] = "-threads " . $threads;
        $cmd[] = "-timeout " . $timeout;

        $cmd = implode(" ", $cmd);

        return $cmd;
    }

    /**
     * Create a python command with user provided "username list" and passwords via selected wordlist.
     *
     * @param string      $url
     * @param string      $usernames
     * @param string      $passwords
     * @param int         $threads
     * @param int         $timeout
     *
     * @return string
     */
    public static function createWithUsernames(
        string $url,
        string $usernames,
        string $passwords,
        int $threads,
        int $timeout
    ): string {
        $cmd = [];
        $cmd[] = config("toolset.bin.python3");
        $cmd[] = config("toolset.path.htbrute_specific_usernamnes");
        $cmd[] = "-url " . $url;
        $cmd[] = "-userlist " . $usernames;
        $cmd[] = "-passlist " . $passwords;
        $cmd[] = "-threads " . $threads;
        $cmd[] = "-timeout " . $timeout;

        $cmd = implode(" ", $cmd);

        return $cmd;
    }
}